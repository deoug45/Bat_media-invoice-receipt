<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>BAT_MEDIA — Invoice & Receipt</title>

  <!-- Favicon: replace with your logo file -->
  <link rel="icon" href="BAT LOGO.png" type="image/png" />

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1fa3d8">

  <link rel="stylesheet" href="styles.css" />
  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <button id="burger" class="burger mobile-only" aria-label="Open menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
      <div class="brand">BAT_MEDIA</div>
      <div class="top-actions">
        <button id="installBtn" class="btn subtle" title="Install app" style="display:none">Install</button>
      </div>
    </header>

    <div id="overlay" class="overlay" hidden></div>

    <main class="main">
      <!-- Editor panel -->
      <aside id="editorPanel" class="editor-panel" aria-hidden="false" role="dialog" aria-label="Editor menu">
        <div class="editor-header">
          <strong>Menu</strong>
          <button id="closeEditor" class="close mobile-only" aria-label="Close editor">✕</button>
        </div>

        <div class="editor-scroll">
          <nav class="side-nav">
            <button id="tab-invoice" class="tab active">Invoice</button>
            <button id="tab-receipt" class="tab">Receipt</button>
            <button id="tab-sales" class="tab">Sales</button>
            <hr/>
          </nav>

          <section class="editor-section">
            <h4>Company</h4>
            <label>Company name
              <input id="companyName" value="BAT_MEDIA LTD" />
            </label>
            <label>Tagline
              <input id="companyTag" value="DESIGN PRINT BRAND" />
            </label>
            <label>Address / Contact
              <textarea id="companyAddress">NBC Building, Suite Z709, Nasser Rd, Kampala
Tel: 0758-400885 / 0200-985540</textarea>
            </label>

            <h4>Document</h4>
            <label>Document No
              <input id="docNo" value="2025-0001" />
            </label>
            <label>Date
              <input id="docDate" type="date" />
            </label>
            <label>Customer / Bill to
              <input id="billTo" value="Kyamuhunga People's Sacco" />
            </label>
            <label>Reason / Notes
              <input id="reason" value="E-Flyer design" />
            </label>

            <hr/>

            <h4>Items — Invoice</h4>
            <table class="editor-table" id="invoiceEditorTable">
              <thead><tr><th>Item</th><th>Qty</th><th>Unit</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
            <div class="editor-controls">
              <button id="invAddRow" class="btn">Add Item</button>
              <button id="invClear" class="btn subtle">Clear</button>
            </div>

            <h4>Items — Receipt</h4>
            <table class="editor-table" id="receiptEditorTable">
              <thead><tr><th>#</th><th>Description</th><th>Qty</th><th>Unit</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
            <div class="editor-controls">
              <button id="recAddRow" class="btn">Add Row</button>
              <button id="recClear" class="btn subtle">Clear</button>
            </div>

            <h4>Payment</h4>
            <label>Amount Paid (UGX)
              <input id="amountPaid" type="number" min="0" value="0" inputmode="numeric" />
            </label>

            <hr/>

            <h4>Export quality</h4>
            <label>PNG DPI
              <select id="exportDPI">
                <option value="200">200 DPI (smaller)</option>
                <option value="300">300 DPI (higher)</option>
              </select>
            </label>
            <label>PDF Image Quality
              <input id="pdfQuality" type="range" min="0.6" max="0.95" step="0.05" value="0.85" />
              <div class="range-value"><span id="pdfQualityValue">0.85</span></div>
            </label>

            <div class="editor-actions">
              <button id="saveHistory" class="btn primary">Save</button>
              <button id="previewBtn" class="btn">Preview</button>
              <button id="exportPNG" class="btn">Download PNG</button>
              <button id="exportPDF" class="btn">Download PDF</button>
              <button id="clearAll" class="btn subtle">Reset</button>
            </div>

            <hr/>
            <h4>History</h4>
            <div id="historyList" class="history-list"></div>
          </section>
        </div>
      </aside>

      <section class="preview-area">
        <div id="previewWrapper" class="preview-wrapper">
          <!-- Invoice preview -->
          <article id="invoice" class="document">
            <div class="doc-inner">
              <header class="doc-header">
                <div class="left-col">
                  <!-- embedded header logo: put BAT LOGO.png into project root -->
                  <img id="headerLogoImg" src="BAT LOGO.png" alt="BAT_MEDIA logo" class="logo-img" />
                </div>

                <div class="center-col">
                  <div id="companyNameView" class="company-name">BAT_MEDIA LTD</div>
                  <div id="companyTagView" class="company-tag">DESIGN PRINT BRAND</div>
                  <div id="companyAddressView" class="company-address">NBC Building, Suite Z709, Nasser Rd, Kampala<br/>Tel: 0758-400885 / 0200-985540</div>
                </div>

                <div class="right-col meta-col">
                  <div><strong>No:</strong> <span id="docNoView">2025-0001</span></div>
                  <div><strong>Date:</strong> <span id="docDateView"></span></div>
                </div>
              </header>

              <div class="title-row">
                <h2>INVOICE</h2>
                <div class="bill-row">
                  <div><strong>Bill to:</strong> <span id="billToView">Customer</span></div>
                  <div><strong>Reason:</strong> <span id="reasonView">Reason</span></div>
                </div>
              </div>

              <div class="table-card">
                <table class="items" id="itemsTable">
                  <thead>
                    <tr>
                      <th class="desc">Description</th>
                      <th class="qty">Quantity</th>
                      <th class="unit">Unit Price (UGX)</th>
                      <th class="total">Total (UGX)</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>

              <div class="totals">
                <div class="words"><strong>Amount in words:</strong> <div id="amountWords" class="words-text">Zero</div></div>
                <div class="totals-boxes">
                  <div class="box"><label>Total</label><div id="totalValue">0</div></div>
                  <div class="box"><label>Paid</label><div id="depositValue">0</div></div>
                  <div class="box"><label>Balance</label><div id="balanceValue">0</div></div>
                </div>
              </div>

              <footer class="doc-footer">
                <div class="footer-left">
                  <div id="footerLogoPlaceholder" class="logo-placeholder">
                    <img id="footerLogoImg" src="BAT LOGO.png" alt="logo" class="footer-logo"/>
                  </div>
                  <div class="signature-details">
                    <div class="sig-caption">Authorised signature</div>
                    <div class="sig-preview">
                      <!-- embedded signature: put bat signature.png into project root -->
                      <img id="signatureImg" src="bat signature.png" alt="signature" class="sig-img" />
                    </div>
                  </div>
                </div>

                <div class="footer-center">
                  <canvas id="qrInvoice" class="qr"></canvas>
                  <div class="thankyou">Thank you for your business — BAT_MEDIA LTD</div>
                </div>

                <div class="footer-right"></div>
              </footer>
            </div>
          </article>

          <!-- Receipt preview -->
          <article id="receipt" class="document hidden">
            <div class="doc-inner">
              <header class="doc-header">
                <div class="left-col">
                  <img id="headerLogoImgR" src="BAT LOGO.png" alt="BAT_MEDIA logo" class="logo-img" />
                </div>

                <div class="center-col">
                  <div id="companyNameViewR" class="company-name">BAT_MEDIA LTD</div>
                  <div id="companyTagViewR" class="company-tag">DESIGN PRINT BRAND</div>
                  <div id="companyAddressViewR" class="company-address">NBC Building, Suite Z709, Nasser Rd, Kampala<br/>Tel: 0758-400885 / 0200-985540</div>
                </div>

                <div class="right-col meta-col">
                  <div><strong>No:</strong> <span id="docNoViewR">0001</span></div>
                  <div><strong>Date:</strong> <span id="docDateViewR"></span></div>
                </div>
              </header>

              <div class="title-row">
                <h2>RECEIPT</h2>
                <div class="bill-row">
                  <div><strong>M/s:</strong> <span id="billToViewR">Customer</span></div>
                  <div><strong>Reason:</strong> <span id="reasonViewR">Reason</span></div>
                </div>
              </div>

              <div class="table-card">
                <table class="items receipt-table" id="receiptItems">
                  <thead>
                    <tr>
                      <th class="no">No.</th>
                      <th class="desc">Description</th>
                      <th class="qty">Qty</th>
                      <th class="unit">Unit Price (UGX)</th>
                      <th class="total">Total (UGX)</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>

              <div class="totals">
                <div class="words"><strong>Amount in words:</strong> <div id="amountWordsR" class="words-text">Zero</div></div>
                <div class="totals-boxes">
                  <div class="box"><label>Total</label><div id="totalValueR">0</div></div>
                </div>
              </div>

              <footer class="doc-footer">
                <div class="footer-left">
                  <div id="footerLogoPlaceholderR" class="logo-placeholder">
                    <img id="footerLogoImgR" src="BAT LOGO.png" alt="logo" class="footer-logo"/>
                  </div>
                  <div class="signature-details">
                    <div class="sig-caption">Authorised signature</div>
                    <div class="sig-preview">
                      <img id="signatureImgR" src="bat signature.png" alt="signature" class="sig-img" />
                    </div>
                  </div>
                </div>

                <div class="footer-center">
                  <canvas id="qrReceipt" class="qr"></canvas>
                  <div class="thankyou">Thank you for your payment — BAT_MEDIA LTD</div>
                </div>

                <div class="footer-right"></div>
              </footer>
            </div>
          </article>

          <!-- Sales & Customers -->
          <article id="sales" class="document hidden">
            <div class="doc-inner">
              <h3>Sales & Customers</h3>
              <div id="salesSummary"></div>
              <div id="salesByDay" class="sales-by-day"></div>
            </div>
          </article>
        </div>
      </section>
    </main>

    <!-- Preview modal -->
    <div id="previewModal" class="modal" aria-hidden="true">
      <div class="modal-content">
        <button id="closePreview" class="modal-close" aria-label="Close preview">✕</button>
        <img id="previewImage" alt="Document preview" />
        <div class="modal-actions">
          <button id="modalDownloadPNG" class="btn">Download PNG</button>
          <button id="modalDownloadPDF" class="btn">Download PDF</button>
        </div>
      </div>
    </div>

    <!-- Simple install prompt (PWA only) -->
    <div id="installPrompt" class="install-prompt" hidden aria-hidden="true">
      <div class="install-inner">
        <div class="install-text">Install BAT_MEDIA for faster access</div>
        <div class="install-actions">
          <button id="installNow" class="btn primary">Install</button>
          <button id="installLater" class="btn subtle">Later</button>
        </div>
      </div>
    </div>

    <div id="toast" class="toast" aria-live="polite"></div>
  </div>

  <script src="script.js"></script>
</body>
</html>